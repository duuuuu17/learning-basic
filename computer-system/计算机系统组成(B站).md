# 计算机系统组成

#### 什么是操作系统？

操作系统作为硬件与软件之间的一个中间人，给用户提供良好界面、标准函数库和方便编程功能的软件，也是管理硬件资源和软件资源的软件，且能阻止用户的错误操作和程序的执行错误。

## 层次结构

应用程序<--操作系统-->硬件。

### 接口

操作系统作为中间层，给应用程序层和硬件层提供接口。

操作系统层给应用程序提供调用硬件资源的接口（硬件资源被操作系统虚拟化）

操作系统是物理资源的接口。

#### 硬件--硬件

USB、HDMI等等。

#### 软件--硬件

软件通过操作系统调用指令集来使用硬件资源。

#### 软件--软件

软件通过API调用，程序之间能够互相通信。

### 操作系统

#### 用户角度

有用户界面；能够使用标准的函数库；能够编程方便而不容易出错。

#### 系统角度

能够管理硬件资源（如：处理器、存储器、I/O设备），也能够管理软件资源（如：文件）

在遇到资源申请的冲突时，能够解决。

阻止错误的发生和不当使用计算机行为。

## 组成

**由CPU（计算器、运算器）、存储器（主存、外存），I/O设备组成**。它们通过**总线BUS**进行**数据传输**，从而达到通信。

### 磁盘：

由盘片、磁头组成。其中的细化，**扇区**为最小存储区块、**磁道**为磁头能够访问的同心圆、**盘片**为物理意义上的数据存储载体、**柱面**，即所有盘片相同磁道构成的立面体（磁道+磁头，因为磁头一般同时访问同一个方向的磁道。）

#### 主引导扇区（boot sector）

硬盘的**0柱面、0磁头、1扇区**被称为主引导扇区。其主要存放着MBR（**主引导记录**），将操作系统拉起（bootstrap）。主要存放在固件上，比如：在ROM、EPPROM

##### 主引导记录

是一串代码，作用是将操作系统拉起（bootstrap）。

##### 作用

<font color=blue>用于硬盘启动时，将系统控制权转给用户指定的分区表中的某个操作系统分区。</font>

##### 特点

不属于任何一个操作系统，具有独立性（**公共引导特性**）。

该扇区是在硬盘分区时由分区软件写入。

## CPU

### 中断

当事件发生时，CPU会收到一个中断信号（分为硬中断和软件中断），则CPU会停止执行该程序，将该事件挂起，去做中断处理程序中的其他事件，执行完毕后会返回到该事件的中断位置并继续执行。

### 指令

其指令主要存储于主存中。

#### load：

CPU从主存读取数据，写入寄存器。

#### store：

将寄存器数据写入到主存中。

## I/O结构

### 驱动程序：

为硬件与操作系统通信的接口。其一般安装于操作系统中。

当我们编辑代码想要在屏幕上显示，其数据传输过程为：

代码-->编译-->CPU执行从主存读取到寄存器-->CPU执行代可执行文件-->在OS中查找需要使用的硬件的驱动程序-->告诉驱动程序需要使用什么功能-->驱动程序将该功能翻译为指令-->硬件控制器接受指令并执行--->执行完毕-->逐层返回最后告知用户执行完毕。

# 计算机体系结构

## 单一计算机

### 单处理器系统

### 定义

**只有一颗主CPU**，<font color=red>执行通用指令集。</font>

#### 其他专用处理器

**该处理器为特定的I/O设备服务**，如：磁盘、键盘、图形控制器等。这些专用处理器执行的指令有限，**不负责处理用户进程**，只接收操作系统发出的指令并被监控。

### 多核处理器

### 定义

有两个及以上且紧密通讯的CPU，它们**共享**<font color=red>**计算机总线**、**时钟**、**主存**、**外设**</font>等

### 非对称处理

CPU的核心被分为<font color=red>主核和从核</font>，主核：被分配任务的主要部分（负责计算量最大的部分），从核：平均分配剩余任务。

### 对称处理(SMP)

CPU的每个核心都具有同等地位。



## 计算机集群

### 集群系统

#### 定义

有多台可独立运行的计算机（节点）通过网络（或其他通信设备）连接所组成一个整体。**集群中的所有计算机可对一个应用程序并发执行。**

#### 特点

节点可为单/多核处理器系统，以及它们之间的关系为**松耦合**。

#### 服务：

高可用性、高性能计算、

##### 并行计算

一个程序划分多个部分，每个部分可并行运行在计算机或集群计算机的各个核上。部分--整体

共享访问、系统应对针对文件访问加以控制与加锁，以便确保没有冲突操作。

例如：分布锁管理器（DLM）。解决操作系统支持多个主机同时访问数据问题。

#### 存储域网：

SAN可让许多系统访问统一存储池。它可以存储应用程序和数据，集群软件可将应用程序交给SAN中的任何主机运行，当主机出错，可由其他主机接管。

# 操作系统的结构

## 单用户单道模式

### 定义

在执行一个程序期间，只有一个用户具有使用权限。在任务执行完毕后，才会分配给下一人使用。

## 多道程序设计

### 定义

<font color=red>**是一种思想或者模式。**</font>

相比于单道模式，会有CPU空间时间，**多道程序设计通过安排作业（编码和数据），使CPU总有一个执行任务，提高CPU利用率**。

#### 作业池

其作业首先保存在磁盘的作业池上（因为主存的大小问题）。

该作业池包含了磁盘上的、等待分配内存的所有进程。

### 实现的硬件保证：

<u>处理器</u>和<u>I/O设备</u>具有**并行工作**的能力。



## 分时系统

也称多任务系统，是多道程序设计的自然**延伸**。

### 允许多个用户共享一台计算机

用户只有I/O设备；分时系统为每个用户轮流分配等长CPU时间；

#### 响应时间

用户从发出指令到得到结果的时间，响应时间随用户越多而越长。

操作系统中多个应用程序使用了该设计模式。

tip：第一个分时系统CTSS由MIT于1962年开发。

# 策略

## 处理器调度

### 定义

不同的程序所使用处理器的优先级不同，处理器对应给予的时间和优先级也需要管理

## 交换

### 定义

主存中暂时不需要使用的程序（给需要存放在主存的程序腾位置），存放在磁盘的一个特殊存储空间中，而这个空间叫：虚拟内存。

## 虚拟内存

### 定义

如上一个所述：用于存放主存暂时不需要使用的程序的存储区域。

## 磁盘管理

### 定义

管理磁盘的程序

## 同步

### 定义



## 死锁

### 定义